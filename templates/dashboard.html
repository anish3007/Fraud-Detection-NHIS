<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>NHIS Claims Auditor Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body class="p-4">
    <div class="container">
      <h1>NHIS Claims Auditor Dashboard</h1>
      <div class="row my-3">
        <div class="col">
          <div class="card p-3">Total Claims: <strong>{{ total }}</strong></div>
        </div>
        <div class="col">
          <div class="card p-3">Avg Charge: <strong>{{ avg_charge }}</strong></div>
        </div>
      </div>

      <div class="my-3">
        <a href="/claims" class="btn btn-primary">Open Claims Review</a>
      </div>

      <h3 class="mt-4">Fraud Score Distribution (by billed amount heuristic)</h3>

      <div class="row my-3">
        <div class="col-md-4">
          <div class="card p-3 text-center">
            <div class="h6 text-success">Low</div>
            <div class="h3">{{ score_counts[0] }}</div>
            <div class="text-muted">{{ ((score_counts[0] / (total if total else 1)) * 100) | round(1) }}%</div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card p-3 text-center">
            <div class="h6 text-warning">Medium</div>
            <div class="h3">{{ score_counts[1] }}</div>
            <div class="text-muted">{{ ((score_counts[1] / (total if total else 1)) * 100) | round(1) }}%</div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card p-3 text-center">
            <div class="h6 text-danger">High</div>
            <div class="h3">{{ score_counts[2] }}</div>
            <div class="text-muted">{{ ((score_counts[2] / (total if total else 1)) * 100) | round(1) }}%</div>
          </div>
        </div>
      </div>

      <canvas id="scoreChart" width="400" height="120"></canvas>

      <script>
  const counts = {{ score_counts | tojson }};
        new Chart(document.getElementById('scoreChart'), {
          type: 'bar',
          data: {
            labels: ['Low','Medium','High'],
            datasets: [{ label: 'Claims', data: counts, backgroundColor: ['#4caf50','#ff9800','#f44336'] }]
          }
        });
      </script>

    </div>
  </body>
</html>
